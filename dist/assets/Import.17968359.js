import{r as c,J as s,k as e,aa as _}from"./index.dff4e684.js";import{r as z,u as I}from"./xlsx.8087b80f.js";import{u as O}from"./file-uploader.f263979f.js";import{E as R}from"./index.4a7b49a1.js";import{R as x,C as p}from"./Col.96fcbc17.js";import{C as y}from"./Card.514988a9.js";import{C as W}from"./CardBody.8c73518d.js";import{C as A}from"./CardHeader.5294cf1e.js";import{C as B}from"./CardTitle.aebc4d98.js";import{T as E}from"./Table.bba57361.js";import{I as H}from"./App.37a2596a.js";import{L as X}from"./Label.138433f0.js";import{D as J}from"./download-cloud.bfc41e4b.js";import"./tslib.17479ed9.js";const ne=()=>{const[C,w]=c.exports.useState(""),[d,f]=c.exports.useState(""),[l,S]=c.exports.useState([]),[D,N]=c.exports.useState([]),j=(t,r)=>{S(t),w(r)},{getRootProps:k,getInputProps:v}=O({multiple:!1,onDrop:t=>{const r=new FileReader;r.onload=function(){const i=r.result,n=z(i,{type:"binary"});n.SheetNames.forEach(function(a){const o=I.sheet_to_row_object_array(n.Sheets[a]);j(o,t[0].name)})},t.length&&t[0].name.endsWith("xlsx")?r.readAsBinaryString(t[0]):_.error(()=>s("p",{className:"mb-0",children:["You can only upload ",e("span",{className:"fw-bolder",children:".xlsx"}),", ",e("span",{className:"fw-bolder",children:".xls"})," &"," ",e("span",{className:"fw-bolder",children:".csv"})," Files!."]}),{style:{minWidth:"380px"}})}}),T=t=>{const r=l;let i=[];const n=t.target.value;if(f(n),n.length)i=r.filter(a=>{const o=Object.keys(a),m=o.filter(u=>a[u].toString().toLowerCase().startsWith(n.toLowerCase())),g=o.filter(u=>a[u].toString().toLowerCase().includes(n.toLowerCase()));return m.length?a[m]:!m&&g.length?a[g]:null}),N(i),f(n);else return null},b=l.length?l.map((t,r)=>r===0?[...Object.keys(t)]:null):[],h=d.length?D:l.length&&!d.length?l:null,L=()=>h!==null&&h.length?h.map((t,r)=>{const n=Object.keys(t).map((a,o)=>e("td",{children:t[a]},o));return e("tr",{children:n},r)}):null,F=()=>b.length?b[0].map((t,r)=>e("th",{children:t},r)):null;return s(c.exports.Fragment,{children:[e(R,{title:"XLSX",subTitle:"Xlsx is a parser and writer for various spreadsheet formats",link:"https://github.com/SheetJS/sheetjs"}),s(x,{className:"import-component",children:[e(p,{sm:"12",children:e(y,{children:e(W,{children:e(x,{children:e(p,{sm:"12",children:s("div",{...k({className:"dropzone"}),children:[e("input",{...v()}),s("div",{className:"d-flex align-items-center justify-content-center flex-column",children:[e(J,{size:64}),e("h5",{children:"Drop Files here or click to upload"}),s("p",{className:"text-secondary",children:["Drop files here or click"," ",e("a",{href:"/",onClick:t=>t.preventDefault(),children:"browse"})," ","thorough your machine"]})]})]})})})})})}),l.length?e(p,{sm:"12",children:s(y,{children:[s(A,{className:"justify-content-between flex-wrap",children:[e(B,{tag:"h4",children:C}),s("div",{className:"d-flex align-items-center justify-content-end",children:[e(X,{for:"search-input",className:"me-1",children:"Search"}),e(H,{id:"search-input",type:"text",bsSize:"sm",value:d,onChange:t=>T(t)})]})]}),s(E,{className:"table-hover-animation",responsive:!0,children:[e("thead",{children:e("tr",{children:F()})}),e("tbody",{children:L()})]})]})}):null]})]})};export{ne as default};
