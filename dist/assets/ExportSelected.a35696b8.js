import{r as i,J as n,j,k as e,B as p}from"./index.dff4e684.js";import{E as T}from"./index.4a7b49a1.js";import{R as B,C as W}from"./Col.96fcbc17.js";import{C as z}from"./Card.514988a9.js";import{C as A}from"./CardBody.8c73518d.js";import{M as H,a as K}from"./ModalBody.fe13b04c.js";import{M as J}from"./ModalHeader.73c2755d.js";import{M as O}from"./ModalFooter.f3952666.js";import{T as X}from"./Table.bba57361.js";import{I as m}from"./App.37a2596a.js";import{L as $}from"./Label.138433f0.js";import{u as w,a as G}from"./xlsx.8087b80f.js";import"./Portal.330fdcf6.js";import"./Fade.f1e5f77c.js";const I=[{id:1,name:"Leanne Graham",username:"Bret",email:"Sincere@april.biz",website:"hildegard.org"},{id:2,name:"Ervin Howell",username:"Antonette",email:"Shanna@melissa.tv",website:"anastasia.net"},{id:3,name:"Clementine Bauch",username:"Samantha",email:"Nathan@yesenia.net",website:"ramiro.info"},{id:4,name:"Patricia Lebsack",username:"Karianne",email:"Julianne.OConner@kory.org",website:"kale.biz"},{id:5,name:"Chelsey Dietrich",username:"Kamren",email:"Lucio_Hettinger@annie.ca",website:"demarco.info"},{id:6,name:"Mrs. Dennis Schulist",username:"Leopoldo_Corkery",email:"Karley_Dach@jasper.info",website:"ola.org"},{id:7,name:"Kurtis Weissnat",username:"Elwyn.Skiles",email:"Telly.Hoeger@billy.biz",website:"elvis.io"},{id:8,name:"Nicholas Runolfsdottir V",username:"Maxime_Nienow",email:"Sherwood@rosamond.me",website:"jacynthe.com"},{id:9,name:"Glenna Reichert",username:"Delphine",email:"Chaim_McDermott@dana.io",website:"conrad.com"},{id:10,name:"Clementina DuBuque",username:"Moriah.Stanton",email:"Rey.Padberg@karina.biz",website:"ambrose.net"}],le=()=>{const[o]=i.exports.useState(I),[f,b]=i.exports.useState(""),[C,L]=i.exports.useState(!1),[h,x]=i.exports.useState(""),[k,v]=i.exports.useState([]),[g,N]=i.exports.useState([]),[u,E]=i.exports.useState("xlsx"),[l,S]=i.exports.useState([]),c=()=>L(!C),M=t=>{let s=[];const a=t.target.value;b(a),a.length&&(s=o.filter(r=>{const d=r.name.toLowerCase().startsWith(a.toLowerCase())||r.email.toLowerCase().startsWith(a.toLowerCase())||r.website.toLowerCase().startsWith(a.toLowerCase())||r.id.toString().toLowerCase().startsWith(a.toLowerCase()),y=r.name.toLowerCase().includes(a.toLowerCase())||r.email.toLowerCase().includes(a.toLowerCase())||r.website.toLowerCase().includes(a.toLowerCase())||r.id.toString().toLowerCase().includes(a.toLowerCase());return d||(!d&&y?y:null)}),b(a),v(s))},D=()=>{const t=g;o.map(d=>l.includes(d.id)?t.push(d):null),N([...t]);const s=h.length?`${h}.${u}`:`excel-sheet.${u}`,a=w.json_to_sheet(g),r=w.book_new();w.book_append_sheet(r,a,"test"),G(r,s),c()},F=t=>{const s=l;if(!s.includes(t))s.push(t);else if(s.includes(t))s.splice(s.indexOf(t),1);else return null;S([...s])},R=()=>{let t=l;if(t.length<o.length)t=o.map(a=>a.id);else if(t.length===o.length)t=[];else return null;S(t)},_=(f?k:o).map(t=>n("tr",{className:j({selected:l.includes(t.id)}),children:[e("td",{children:e("div",{className:"form-check",children:e(m,{id:t.id,type:"checkbox",onChange:()=>F(t.id),checked:!!l.includes(t.id)})})}),e("td",{children:t.email}),e("td",{children:t.name}),e("td",{children:t.website}),e("td",{children:t.id})]},t.id));return n(i.exports.Fragment,{children:[e(T,{title:"XLSX",subTitle:"Xlsx is a parser and writer for various spreadsheet formats",link:"https://github.com/SheetJS/sheetjs"}),e(B,{className:"export-component",children:e(W,{sm:"12",children:n(z,{children:[e(A,{className:"pb-0",children:n("div",{className:"d-flex flex-wrap justify-content-between",children:[e(p,{color:"primary",onClick:()=>c(),children:"Export Selected"}),n("div",{className:"d-flex align-items-center justify-content-end",children:[e($,{for:"search-input",className:"me-1",children:"Search"}),e(m,{id:"search-input",bsSize:"sm",type:"text",value:f,onChange:t=>M(t)})]})]})}),n(X,{className:"table-hover-animation mt-2",responsive:!0,children:[e("thead",{children:n("tr",{children:[e("th",{children:e("div",{className:"form-check",children:e(m,{type:"checkbox",id:"select-all",label:"",checked:!!l.length,onChange:()=>R()})})}),e("th",{children:"Email"}),e("th",{children:"Name"}),e("th",{children:"Website"}),e("th",{children:"Rank"})]})}),e("tbody",{children:_})]})]})})}),n(H,{isOpen:C,toggle:()=>c(),className:"modal-dialog-centered",onClosed:()=>x(""),children:[e(J,{toggle:()=>c(),children:"Export To Excel"}),n(K,{children:[e("div",{className:"mb-2",children:e(m,{type:"text",value:h,onChange:t=>x(t.target.value),placeholder:"Enter File Name"})}),e("div",{children:n(m,{type:"select",id:"selectFileFormat",name:"customSelect",value:u,onChange:t=>{E(t.target.value)},children:[e("option",{children:"xlsx"}),e("option",{children:"csv"}),e("option",{children:"txt"})]})})]}),n(O,{children:[e(p,{color:"primary",onClick:()=>D(),children:"Export"}),e(p,{color:"flat-danger",onClick:()=>c(),children:"Cancel"})]})]})]})};export{le as default};
